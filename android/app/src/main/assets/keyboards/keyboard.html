<!--
  ~ Copyright (c) 2023 Fime project https://fime.fit
  ~ Initial author: zelde126@126.com
  -->

<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="fime.css">
    <style>
        /* your css here */
    </style>
    <title>Keyboard</title>
</head>

<body class="fime-box">
    <div class="fime-kbd-box" data-layout="qwerty">
        <div class="fime-key-row">
            <div class="fime-key">
                <span class="fime-symbol">1</span>
                <span class="fime-label">q</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">2</span>
                <span class="fime-label">w</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">3</span>
                <span class="fime-label">e</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">4</span>
                <span class="fime-label">r</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">5</span>
                <span class="fime-label">t</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">6</span>
                <span class="fime-label">y</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">7</span>
                <span class="fime-label">u</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">8</span>
                <span class="fime-label">i</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">9</span>
                <span class="fime-label">o</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">0</span>
                <span class="fime-label">p</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-box">
                &emsp;
            </div>
            <span class="fime-key">
                <span class="fime-symbol">!</span>
                <span class="fime-label">a</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">@</span>
                <span class="fime-label">s</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">#</span>
                <span class="fime-label">d</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">$</span>
                <span class="fime-label">f</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">%</span>
                <span class="fime-label">g</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">^</span>
                <span class="fime-label">h</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">&</span>
                <span class="fime-label">j</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">*</span>
                <span class="fime-label">k</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">\</span>
                <span class="fime-label">l</span>
            </span>
            <div class="fime-box">
                &emsp;
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⇧</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">(</span>
                <span class="fime-label">z</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">)</span>
                <span class="fime-label">x</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">[</span>
                <span class="fime-label">c</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">]</span>
                <span class="fime-label">v</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">{</span>
                <span class="fime-label">b</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">}</span>
                <span class="fime-label">n</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">/</span>
                <span class="fime-label">m</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⌫</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey">
                <span class="fime-label">En</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">;</span>
                <span class="fime-label">'</span>
            </div>
            <div class="fime-key" style="width: 300%;">
                <span class="fime-label">Space</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">，</span>
                <span class="fime-label">,</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">。</span>
                <span class="fime-label">.</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⏎</span>
            </div>
        </div>
    </div>

    <div class="fime-kbd-box" data-layout="abc">
        <div class="fime-key-row">
            <div class="fime-key">
                <span class="fime-symbol">1</span>
                <span class="fime-label">q</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">2</span>
                <span class="fime-label">w</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">3</span>
                <span class="fime-label">e</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">4</span>
                <span class="fime-label">r</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">5</span>
                <span class="fime-label">t</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">6</span>
                <span class="fime-label">y</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">7</span>
                <span class="fime-label">u</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">8</span>
                <span class="fime-label">i</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">9</span>
                <span class="fime-label">o</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">0</span>
                <span class="fime-label">p</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-box">
                &emsp;
            </div>
            <span class="fime-key">
                <span class="fime-symbol">!</span>
                <span class="fime-label">a</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">@</span>
                <span class="fime-label">s</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">#</span>
                <span class="fime-label">d</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">$</span>
                <span class="fime-label">f</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">%</span>
                <span class="fime-label">g</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">^</span>
                <span class="fime-label">h</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">&</span>
                <span class="fime-label">j</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">*</span>
                <span class="fime-label">k</span>
            </span>
            <span class="fime-key">
                <span class="fime-symbol">\</span>
                <span class="fime-label">l</span>
            </span>
            <div class="fime-box">
                &emsp;
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⇧</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">(</span>
                <span class="fime-label">z</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">)</span>
                <span class="fime-label">x</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">[</span>
                <span class="fime-label">c</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">]</span>
                <span class="fime-label">v</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">{</span>
                <span class="fime-label">b</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">}</span>
                <span class="fime-label">n</span>
            </div>
            <div class="fime-key">
                <span class="fime-symbol">/</span>
                <span class="fime-label">m</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⌫</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey">
                <span class="fime-label">123</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">🔙</span>
            </div>
            <div class="fime-key" style="width: 300%;">
                <span class="fime-label">Space</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">¥</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⏎</span>
            </div>
        </div>
    </div>

    <div class="fime-kbd-box" data-layout="digital">
        <div class="fime-key-row">
            <div class="fime-key-box fime-key-col" style="width: 12%; height: 144px;">
                <div class="fime-key fime-fnkey" style="border-radius:0; border-bottom: 1px solid #aaadb4;">
                    <span class="fime-label" style="line-height: 30px;">，</span>
                </div>
                <div class="fime-key fime-fnkey" style="border-radius:0; border-bottom: 1px solid #aaadb4;">
                    <span class="fime-label" style="line-height: 30px;">。</span>
                </div>
                <div class="fime-key fime-fnkey" style="border-radius:0; border-bottom: 1px solid #aaadb4;">
                    <span class="fime-label" style="line-height: 30px;">？</span>
                </div>
                <div class="fime-key fime-fnkey" style="border-radius:0; border-bottom: 1px solid #aaadb4;">
                    <span class="fime-label" style="line-height: 30px;">！</span>
                </div>
            </div>
            <div>&nbsp;</div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">1</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">2</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">3</span>
            </div>
            <div class="fime-key fime-fnkey" style="width: 8%;">
                <span class="fime-label">⌫</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key-col" style="width: 12%;">&emsp;</div>
            <div>&nbsp;</div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">4</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">5</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">6</span>
            </div>
            <div class="fime-key fime-fnkey" style="width: 8%;">
                <span class="fime-label">⏎</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key-col" style="width: 12%;">&emsp;</div>
            <div>&nbsp;</div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">7</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">8</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">9</span>
            </div>
            <div class="fime-key fime-fnkey" style="width: 8%;">
                <span class="fime-label">¥</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey" style="width: 8%;">
                <span class="fime-label">🔙</span>
            </div>
            <div class="fime-key" style="width: 15%;">
                <span class="fime-label">*</span>
            </div>
            <div class="fime-key" style="width: 20%;">
                <span class="fime-label">0</span>
            </div>
            <div class="fime-key" style="width: 15%;">
                <span class="fime-label">#</span>
            </div>
            <div class="fime-key fime-fnkey" style="width: 8%;">
                <span class="fime-label">En</span>
            </div>
        </div>
    </div>

    <div class="fime-kbd-box" data-layout="symbol">
        <div class="fime-key-row">
            <div class="fime-key">
                <span class="fime-label">+</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">-</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">*</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">/</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">.</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">&</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">|</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">(</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">)</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">=</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key">
                <span class="fime-label">±</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">[</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">]</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">{</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">}</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">&lt;</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">&gt;</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">≈</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">≠</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">#</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key">
                <span class="fime-label">@</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">¥</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">$</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">%</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">÷</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">°</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">©</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">®</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">≤</span>
            </div>
            <div class="fime-key">
                <span class="fime-label">≥</span>
            </div>
        </div>
        <div class="fime-key-row">
            <div class="fime-key fime-fnkey">
                <span class="fime-label">123</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">🔙</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">En</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⌫</span>
            </div>
            <div class="fime-key fime-fnkey">
                <span class="fime-label">⏎</span>
            </div>
        </div>
    </div>

    <script src="any-touch.umd.min.js"></script>
    <script src="fime.js"></script>
    <script>
        const layouts = fime.qsa('.fime-kbd-box')
        let defaultLayout = 'qwerty'
        let activeLayout = ''
        switchLayout(defaultLayout)

        let at = new AnyTouch(fime.qs('.fime-box'))
        at.on(['tap', 'panend', 'press'], function (e) {
            console.log(e.type + ' @' + e.target.tagName)
            let t = e.target
            if (e.target.tagName != 'DIV') t = e.target.parentNode
            t.classList.add('fime-key-active')
            if (e.type == 'tap') {
                onTap(t.querySelector('span.fime-label').innerHTML)
            } else if (e.type == 'panend') {
                let s = t.querySelector('span.fime-symbol')
                if (s && e.direction == 'up') {
                    fime.onKey(s.innerHTML)
                }
            }
            setTimeout(function () { t.classList.remove('fime-key-active') }, 200)
        })

        function onTap(name) {
            console.log('on key: ' + name)
            if (name == 'En') {
                switchLayout('abc')
                fime.setMode(0)
            } else if (name == '123') {
                switchLayout('digital')
                fime.setMode(0)
            } else if (name == '🔙') {
                switchLayout(defaultLayout)
                fime.setMode(1)
            } else if (name == '¥') {
                switchLayout('symbol')
                fime.setMode(0)
            } else if (name == 'Space') {
                fime.onKey('VK_SPACE')
            } else if (name == '⌫') {
                fime.onKey('FN_BACKSPACE')
            } else if (name == '⏎') {
                fime.onKey('FN_ENTER')
            } else if (name == "'") {
                fime.onKey('VK_SINGLE_QUOTE')
            } else {
                fime.onKey(name)
            }
        }

        function onSwipe(symbol) {
            console.log('on swipe: ' + symbol)
        }

        function switchLayout(layout) {
            if (activeLayout == layout) return
            console.log('switchLayout:' + layout)
            layouts.forEach(l => {
                l.style.display = l.dataset.layout == layout ? '' : 'none'
            })
            activeLayout = layout
        }

        fime.callNative('getDefaultLayout', {}, function (args) {
            defaultLayout = args['default-layout']
            switchLayout(defaultLayout)
        })

        fime.addListener('onKeyboardLayout', function (json) {
            switchLayout(json.layout)
        })
    </script>
</body>

</html>